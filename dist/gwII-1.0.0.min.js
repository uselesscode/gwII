/*! gwII v1.0.0 2013-09-03
 * Copyright 2013 Peter Johnson
 * Licensed MIT, GPL-3.0
 * https://github.com/uselesscode/gwII
 */
!function(a,b,c){"use strict";function d(a,b){if(a){var c=a.icon_file_id||a.file_id,d=a.icon_file_signature||a.signature,e=b&&b.format?b.format:"jpg";if(e=e.replace(/^\./,""),c&&d)return"https://render.guildwars2.com/file/"+d+"/"+c+"."+e}return null}var e,f=function(a){var b=function(){return(new Date).getTime()},d=function(a){return a&&a.always&&a.done&&a.fail&&a.pipe&&a.progress&&a.promise&&a.state&&a.then?!0:!1},e=function(a){return a&&a.notify&&a.notifyWith&&a.reject&&a.resolve&&a.resolveWith?!0:!1},f=function(a){return d(a)&&e(a)?!0:!1},g=function(a,c){return a.timestamp+c<b()},h=function(){var d={};return{get:function(b,e,h){var i,j=d[b];return e===c&&(e=!0),j&&(f(j.value)&&"pending"===j.value.state()?i=j.value:(e===!0||e!==!1&&!g(j,e))&&(i=j.value,h&&!f(i)&&function(b){i=a.Deferred(),i.resolve(b)}(i))),i},set:function(a,c){var e=b();d[a]={timestamp:e,value:c}},clear:function(){d={}}}};return h}(jQuery),g=a.gw2,h="https://api.guildwars2.com/v1/",i=1e4,j=3e4,k=6e4,l=36e5,m=864e5,n="en",o=["de","en","es","fr"],p=function(a){return a=a.toLowerCase(),-1!==o.indexOf(a)},q=f(),r=function(){return!0},s=function(a){return function(){a.reject()}},t=function(a){var c=b.Deferred();return c.resolve(a).promise()},u=function(a){return b.extend(!0,{},a)},v=function(){var a=Array.prototype.slice.call(arguments,0),b=a.length,c=function(c){var d,e=c;for(d=0;b>d;d+=1)e=a[d](e);return e};return c},w=function(a,d,e,f){var g=b.Deferred(),h=s(g);return d().done(function(b){for(var d,i=0,j=b.length;j>i;){if(d=b[i],d[e]===a){f!==c?g.resolve(d[f]):g.resolve(d);break}i+=1}"resolved"!==g.state()&&h()}).fail(h),g.promise()},x=function(a,b){var d=a;return b!==c&&Object.keys(b).sort().forEach(function(a){d+="_"+a+":"+b[a]}),d},y=function(a,b){var c,d=function(a){return a.id=""===a?null:+a.id,a},e=v(u,d);return b&&b.noNormalize?a:c=a.map(e)},z=function(a,c,d){if(!c||!c.noNormalize){var e=u(a),f=function(a){for(var b=0,c=d.length,e=!1;c>b;b+=1)if(a.match(d[b])){e=!0;break}return e},g=function(a,c){return b.each(a,function(d,e){var h=b.type(e),i=c;"array"!==b.type(a)&&(i+=","+d),"object"===h||"array"===h?a[d]=g(e,i):f(i)&&(a[d]=""===e?null:+e)}),a};return e=g(e,"")}return a},A=function(a,b,c){return c&&c.raw?a:a[b]},B=function(a){if(a&&a.lang){var b=a.lang;if(p(b))return b}return n},C=function(a,b){var d;return b===c&&(b=!0),d=a&&a.cache!==c?a.cache:b},D=function(a,d,e){var f,g,i,j=!1;return null===d&&(d=!1,j=!0),i=e||{},g=x(a,i),f=q.get(g,d,!0),f===c&&(f=b.Deferred(),j||q.set(g,f),b.getJSON(h+a,i,function(a){j||q.set(g,a),f.resolve(a)}).fail(function(){f.reject()})),f.promise()},E=function(a,b){var c;switch(c=b[+a]){case"Castle":return 35;case"Keep":return 25;case"Tower":return 10;default:return 5}},F=function(a,c,d){var e,f=b.Deferred();return e=c instanceof RegExp?c:new RegExp(c,"i"),a(d).done(function(a){var b=a.filter(function(a){return a.name&&a.name&&a.name.match&&a.name.match(e)?!0:!1});f.resolve(b)}).fail(function(){f.reject()}),f.promise()},G={de:{1:"Aussichtspunkt",2:"Tal",3:"Tiefland",4:"Golanta-Lichtung",5:"Pangloss-Anh�he",6:"Speldan Kahlschlag",7:"Danelon-Passage",8:"Umberlichtung-Forst",9:"Schloss Steinnebel",10:"Schurkenbruch",11:"Aldons Vorsprung",12:"Wildbachstrecke",13:"Jerrifers Sumpfloch",14:"Klovan-Senke",15:"Langor-Schlucht",16:"Quentinsee",17:"Mendons Spalt",18:"Anzalias-Pass",19:"Ogerwacht-Kanal",20:"Veloka-Hang",21:"Durios-Schlucht",22:"Bravost-Abhang",23:"Festung",24:"Landgut des Champions",25:"Rotdornstrauch",26:"Gr�nsee",27:"Bucht des Aufstiegs",28:"Horst der Morgend�mmerung",29:"Der Geisterholm",30:"Wald-Freistatt",31:"Askalion-H�gel",32:"Etheron-H�gel",33:"Traumbucht",34:"Sieger-H�tte",35:"Gr�nstrauch",36:"Blausee",37:"Festung",38:"Weitsicht",39:"Das Gottschwert",40:"Felswand",41:"Shadaran-H�gel",42:"Rotsee",43:"H�tte des Helden",44:"Schreckensfall-Bucht",45:"Blaudornstrauch",46:"Festung",47:"Sonnenlichth�gel",48:"Glaubenssprung",49:"Blautal-Zuflucht",50:"Blauwasser-Tiefland",51:"Astralholm",52:"Arahs Hoffnung",53:"Gr�ntal-Zuflucht",54:"Nebel-Freistatt",55:"Rotwasser-Tiefland",56:"Die Titanenpranke",57:"Felsenspitze",58:"G�tterkunde",59:"Rottal-Zuflucht",60:"Sternenhain",61:"Gr�nwasser-Tiefland"},en:{1:"Overlook",2:"Valley",3:"Lowlands",4:"Golanta Clearing",5:"Pangloss Rise",6:"Speldan Clearcut",7:"Danelon Passage",8:"Umberglade Woods",9:"Stonemist Castle",10:"Rogue's Quarry",11:"Aldon's Ledge",12:"Wildcreek Run",13:"Jerrifer's Slough",14:"Klovan Gully",15:"Langor Gulch",16:"Quentin Lake",17:"Mendon's Gap",18:"Anzalias Pass",19:"Ogrewatch Cut",20:"Veloka Slope",21:"Durios Gulch",22:"Bravost Escarpment",23:"Garrison",24:"Champion's demense",25:"Redbriar",26:"Greenlake",27:"Ascension Bay",28:"Dawn's Eyrie",29:"The Spiritholme",30:"Woodhaven",31:"Askalion Hills",32:"Etheron Hills",33:"Dreaming Bay",34:"Victors's Lodge",35:"Greenbriar",36:"Bluelake",37:"Garrison",38:"Longview",39:"The Godsword",40:"Cliffside",41:"Shadaran Hills",42:"Redlake",43:"Hero's Lodge",44:"Dreadfall Bay",45:"Bluebriar",46:"Garrison",47:"Sunnyhill",48:"Faithleap",49:"Bluevale Refuge",50:"Bluewater Lowlands",51:"Astralholme",52:"Arah's Hope",53:"Greenvale Refuge",54:"Foghaven",55:"Redwater Lowlands",56:"The Titanpaw",57:"Cragtop",58:"Godslore",59:"Redvale Refuge",60:"Stargrove",61:"Greenwater Lowlands"},es:{1:"Mirador",2:"Valle",3:"Vega",4:"Claro Golanta",5:"Colina Pangloss",6:"Claro Espeldia",7:"Pasaje Danelon",8:"Bosques Clarosombra",9:"Castillo Piedraniebla",10:"Cantera del P�caro",11:"Cornisa de Aldon",12:"Pista Arroyosalvaje",13:"Cenagal de Jerrifer",14:"Barranco Klovan",15:"Barranco Langor",16:"Lago Quentin",17:"Zanja de Mendon",18:"Paso Anzalias",19:"Tajo de la Guardia del Ogro",20:"Pendiente Veloka",21:"Barranco Durios",22:"Escarpadura Bravost",23:"Fuerte",24:"Dominio del Campe�n",25:"Zarzarroja",26:"Lagoverde",27:"Bah�a de la Ascensi�n",28:"Aguilera del Alba",29:"La Isleta Espiritual",30:"Refugio Forestal",31:"Colinas Askalion",32:"Colinas Etheron",33:"Bah�a On�rica",34:"Albergue del Vencedor",35:"Zarzaverde",36:"Lagoazul",37:"Fuerte",38:"Vistaluenga",39:"La Hoja Divina",40:"Despe�adero",41:"Colinas Shadaran",42:"Lagorrojo",43:"Albergue del H�roe",44:"Bah�a Salto Aciago",45:"Zarzazul",46:"Fuerte",47:"Colina Soleada",48:"Salto de Fe",49:"Refugio Valleazul",50:"Tierras Bajas de Aguazul",51:"Isleta Astral",52:"Esperanza de Arah",53:"Refugio de Valleverde",54:"Refugio Neblinoso",55:"Tierras Bajas de Aguarroja",56:"La Garra del Tit�n",57:"Cumbrepe�asco",58:"Sabidur�a de los Dioses",59:"Refugio Vallerojo",60:"Arboleda de las Estrellas",61:"Tierras Bajas de Aguaverde"},fr:{1:"Belv�d�re",2:"Vall�e",3:"Basses terres",4:"Clairi�re de Golanta",5:"Mont�e de Pangloss",6:"For�t ras�e de Speldan",7:"Passage Danelon",8:"Bois d'Ombreclair",9:"Ch�teau Brumepierre",10:"Carri�re des voleurs",11:"Corniche d'Aldon",12:"Piste du Ruisseau sauvage",13:"Bourbier de Jerrifer",14:"Petit ravin de Klovan",15:"Ravin de Langor",16:"Lac Quentin",17:"Faille de Mendon",18:"Col d'Anzalias",19:"Perc�e de Gardogre",20:"Flanc de Veloka",21:"Ravin de Durios",22:"Falaise de Bravost",23:"Garnison",24:"Fief du champion",25:"Bruyerouge",26:"Lac Vert",27:"Baie de l'Ascension",28:"Promontoire de l'aube",29:"L'antre des esprits",30:"Gentesylve",31:"Collines d'Askalion",32:"Collines d'Etheron",33:"Baie des r�ves",34:"Pavillon du vainqueur",35:"Vertebranche",36:"Lac bleu",37:"Garnison",38:"Longuevue",39:"L'Ep�e divine",40:"Flanc de falaise",41:"Collines de Shadaran",42:"Rougelac",43:"Pavillon du H�ros",44:"Baie du Noir d�clin",45:"Bruyazur",46:"Garnison",47:"Colline ensoleill�e",48:"Ferveur",49:"Refuge de bleubal",50:"Basses terres d'Eau-Azur",51:"Astralholme",52:"Espoir d'Arah",53:"Refuge de Valvert",54:"Havre gris",55:"Basses terres de Rubicon",56:"Bras du titan",57:"Sommet de l'escarpement",58:"Divination",59:"Refuge de Valrouge",60:"Bosquet stellaire",61:"Basses terres d'Eau-Verdoyante"}},H={worldNames:function(a){var c=b.Deferred(),d=C(a,!0),e=B(a);return D("world_names.json",d,{lang:e}).done(function(b){var d=y(b,a);c.resolve(d)}),c.promise()},worldNameFromId:function(a){return a=+a,w(a,H.worldNames,"id","name")},worldNamesContaining:function(a,b){return F(H.worldNames,a,b)},mapNames:function(a){var c=b.Deferred(),d=C(a,!0),e=B(a);return D("map_names.json",d,{lang:e}).done(function(b){var d=y(b,a);c.resolve(d)}).fail(function(){c.reject()}),c.promise()},mapName:function(a){return w(a,H.mapNames,"id","name")},events:function(a,c){var d=b.Deferred(),e=C(c,k);return a=a||{},D("events.json",e,{world_id:a.worldId,map_id:a.mapId,event_id:a.eventId}).done(function(a){d.resolve(A(a,"events",c))}),d.promise()},eventNames:function(a){var b=C(a,m),c=B(a);return D("event_names.json",b,{lang:c})},eventName:function(a){return w(a,H.eventNames,"id","name")},eventNamesContaining:function(a,b){return F(H.eventNames,a,b)},eventNamesAsObject:function(a){var c,d=C(a,m),e=B(a),f="eventNamesAsObject-"+e,g=b.Deferred(),h=s(g);return(c=q.get(f,d,!0))?c:(H.eventNames({lang:e}).done(function(a){var b={};a.forEach(function(a){b[a.id]=a.name}),g.resolve(b),q.set(f,b)}).fail(h),g.promise())},eventDetails:function(a,d){var e=b.Deferred(),f=s(e),g=C(d,!0),h=B(d),i={lang:h};return null===a?a=c:a!==c&&(i.event_id=a),D("event_details.json",g,i).done(function(b){var f=A(b,"events",d);d!==c&&d.raw||a===c||(f=f[a]),e.resolve(f)}).fail(f),e.promise()}},I={items:function(a){var c=C(a,m),d=b.Deferred(),e=s(d);return D("items.json",c).done(function(b){d.resolve(A(b,"items",a))}).fail(e),d.promise()},itemDetails:function(a,c){var d=C(c,l),e=b.Deferred(),f=s(e),g=B(c);return D("item_details.json",d,{lang:g,item_id:a}).done(function(a){var b=["^,item_id$","^,level$","^,vendor_value$",",infix_upgrade,attributes,modifier$",",suffix_item_id$","^,weapon,min_power$","^,weapon,max_power$","^,(?:armor|weapon),defense$",",duration_ms$","^,size$",",skill_id$"],d=z(a,c,b);e.resolve(d)}).fail(f),e.promise()}},J={recipes:function(a){var c=C(a,l),d=b.Deferred(),e=s(d);return D("recipes.json",c).done(function(b){d.resolve(A(b,"recipes",a))}).fail(e),d.promise()},recipeDetails:function(a,c){var d=C(c,m),e=b.Deferred(),f=s(e),g=B(c);return D("recipe_details.json",d,{lang:g,recipe_id:a}).done(function(a){var b=[",recipe_id",",output_item_id",",output_item_count",",min_rating",",time_to_craft_ms",",ingredients,item_id",",ingredients,count"],d=z(a,c,b);e.resolve(d)}).fail(f),e.promise()}},K={matches:function(a){var c=b.Deferred(),d=C(a,l);return D("wvw/matches.json",d).done(function(b){c.resolve(A(b,"wvw_matches",a))}).fail(function(){c.reject()}),c.promise()},match:function(a){return w(a,K.matches,"wvw_match_id")},matchIdFromWorldId:function(a){var c=b.Deferred();return a=+a,K.matches().done(function(b){for(var d,e=0,f=b.length;f>e;e+=1)switch(d=b[e],a){case d.red_world_id:case d.blue_world_id:case d.green_world_id:return c.resolve(d.wvw_match_id),void 0}c.reject()}).fail(function(){c.reject()}),c.promise()},worldMatch:function(a){var c=b.Deferred(),d=s(c);return K.matchIdFromWorldId(a).done(function(a){K.match(a).done(function(a){c.resolve(a)}).fail(d)}).fail(d),c.promise()},matchDetails:function(a,b){var c=C(b,j);return D("wvw/match_details.json",c,{match_id:a})},objectiveNames:function(a){var c=C(a,m),d=B(a),e=b.Deferred();return D("wvw/objective_names.json",c,{lang:d}).done(function(b){var c=y(b,a);e.resolve(c)}).fail(function(){e.reject()}),e.promise()},objectiveNamesAsObject:function(a){var c,d,e,f={},g=C(a,m),h=B(a),i="objectiveNamesAsObject-"+h;return(c=q.get(i,g,!0))?c:(d=b.Deferred(),e=s(d),K.objectiveNames({noNormalize:!0,lang:h}).done(function(a){a.forEach(function(a){f[a.id]=a.name}),d.resolve(f),q.set(i,f)}).fail(e),d.promise())},objectiveName:function(a,c){var d=b.Deferred(),e=s(d),f=B(c);return K.objectiveNamesAsObject({lang:f}).done(function(b){var c=b[+a];c?d.resolve(c):e()}).fail(e),d.promise()},objectiveFullName:function(a,c){var d=b.Deferred(),e=s(d);return K.objectiveFullNamesAsObject(c).done(function(b){var c=b[+a];c?d.resolve(c):e()}).fail(e),d.promise()},objectiveFullNamesAsObject:function(a){var b=B(a);return t(G[b])},objectiveValue:function(a){var c=b.Deferred();return K.objectiveNamesAsObject({lang:"en"}).done(function(b){c.resolve(E(a,b))}).fail(function(){c.reject()}),c.promise()},potentialPoints:function(a,c){var d,e=b.Deferred(),f=s(e),g=r,h=0;return c&&(d=new RegExp("^"+c.substr(0,1),"i"),g=function(a){return d.test(a.type)}),K.matchIdFromWorldId(a).done(function(c){b.when(K.match(c),K.matchDetails(c),K.objectiveNamesAsObject()).done(function(b,c,d){var f;switch(a){case b.red_world_id:f="Red";break;case b.green_world_id:f="Green";break;case b.blue_world_id:f="Blue"}c.maps.filter(g).forEach(function(a){a.objectives.forEach(function(a){a.owner===f&&(h+=E(a.id,d))})}),e.resolve(h)}).fail(f)}).fail(f),e.promise()}},L={maps:function(a,d){var e=b.Deferred(),f=s(e),g=C(d,m),h=B(d),i={lang:h};return null===a?a=c:a!==c&&(a=+a,i.map_id=a),D("maps.json",g,i).done(function(b){var f=A(b,"maps",d);d!==c&&d.raw||a===c||(f=f[a]),e.resolve(f)}).fail(f),e.promise()},continents:function(a){var c=b.Deferred(),d=s(c),e=C(a,m),f=B(a);return D("continents.json",e,{lang:f}).done(function(b){var d=A(b,"continents",a);c.resolve(d)}).fail(d),c.promise()},mapFloors:function(a,b,c){var d=C(c,m),e=B(c),f={lang:e,continent_id:a,floor:b};return D("map_floor.json",d,f)}},M={build:function(a){var c=b.Deferred(),d=C(a,i);return D("build.json",d).done(function(b){var d=A(b,"build_id",a);c.resolve(d)}).fail(function(){c.reject()}),c.promise()},guildDetails:function(a,c){var d={},e=C(c,m);if(a.guildId)d.guild_id=a.guildId;else if(a.guildName)d.guild_name=a.guildName;else{if(!a)return b.Deferred.reject();d.guild_id=a}return D("guild_details.json",e,d)},colors:function(a){var c=C(a,!0),d=b.Deferred(),e=s(d),f=B(a);return D("colors.json",c,{lang:f}).done(function(b){d.resolve(A(b,"colors",a))}).fail(e),d.promise()},files:function(a){var b=C(a,!0);return D("files.json",b,{})}};e=b.extend({},H,M,I,J),e.render=d,e.wvw=K,e.map=L,e.noConfilct=function(){return a.gw2=g,e},e.clearCache=q.clear,e.cache=function(){return f()},Object.defineProperties(e,{lang:{set:function(a){a&&p(a)&&(n=a)},get:function(){return n}}}),a.gw2=e}(window,jQuery);
//@ sourceMappingURL=gwII-1.0.0.min.js.map
